<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MindAR - Modern Web AR</title>
    <script src="https://cdn.jsdelivr.net/gh/hiukim/mind-ar-js@1.2.5/dist/mindar-image.prod.js"></script>
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/hiukim/mind-ar-js@1.2.5/dist/mindar-image-aframe.prod.js"></script>
    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
        }

        #instructions {
            position: fixed;
            top: 10px;
            left: 10px;
            right: 10px;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 15px;
            border-radius: 8px;
            z-index: 1000;
            text-align: center;
            font-size: 14px;
        }

        #controls {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1000;
        }

        .control-btn {
            background: #ff4444;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            margin: 0 5px;
        }
    </style>
</head>
<body>
    <div id="instructions">
        üéØ Point camera at <a href="https://cdn.jsdelivr.net/gh/hiukim/mind-ar-js@1.2.5/examples/image-tracking/assets/card-example/card.png" target="_blank" style="color:#44ff44;">this image</a> to see AR!
    </div>

    <div id="controls">
        <button class="control-btn" onclick="addObject()">Add Object</button>
    </div>

    <a-scene
        mindar-image="imageTargetSrc: https://cdn.jsdelivr.net/gh/hiukim/mind-ar-js@1.2.5/examples/image-tracking/assets/card-example/card.mind;"
        color-space="sRGB"
        renderer="colorManagement: true, physicallyCorrectLights"
        vr-mode-ui="enabled: false"
        device-orientation-permission-ui="enabled: false">

        <a-assets>
            <img id="card" src="https://cdn.jsdelivr.net/gh/hiukim/mind-ar-js@1.2.5/examples/image-tracking/assets/card-example/card.png" />
        </a-assets>

        <!-- Target anchor - objects appear here when image is detected -->
        <a-entity id="target-anchor" mindar-image-target="targetIndex: 0">
            <!-- Demo AR objects -->
            <a-box
                position="0 0 0.1"
                scale="0.5 0.5 0.5"
                material="color: #ff6b6b; transparent: true; opacity: 0.8"
                animation="property: rotation; to: 0 360 0; loop: true; dur: 4000">
            </a-box>

            <a-sphere
                position="0.7 0 0.1"
                radius="0.3"
                material="color: #4ecdc4; transparent: true; opacity: 0.7"
                animation="property: position; to: 0.7 0.5 0.1; dir: alternate; loop: true; dur: 2000">
            </a-sphere>

            <a-cylinder
                position="-0.7 0 0.1"
                radius="0.2"
                height="0.8"
                material="color: #45b7d1; transparent: true; opacity: 0.8"
                animation="property: rotation; to: 360 0 0; loop: true; dur: 3000">
            </a-cylinder>

            <a-text
                value="MindAR Working!"
                position="0 1 0.1"
                align="center"
                color="#ffe66d"
                scale="2 2 2">
            </a-text>
        </a-entity>

        <!-- Camera -->
        <a-entity camera></a-entity>
    </a-scene>

    <script>
        let objectCount = 0;
        let targetAnchor;

        document.addEventListener('DOMContentLoaded', () => {
            targetAnchor = document.querySelector('#target-anchor');

            // Update instructions when tracking starts/stops
            targetAnchor.addEventListener('targetFound', () => {
                document.getElementById('instructions').innerHTML = '‚úÖ Image detected! AR objects should appear.';
            });

            targetAnchor.addEventListener('targetLost', () => {
                document.getElementById('instructions').innerHTML = 'üîç Point camera at the target image to see AR objects.';
            });
        });

        function addObject() {
            if (!targetAnchor) return;

            const colors = ['#ff4444', '#44ff44', '#4444ff', '#ffff44', '#ff44ff', '#44ffff'];
            const shapes = ['box', 'sphere', 'cylinder', 'cone'];

            const color = colors[objectCount % colors.length];
            const shape = shapes[objectCount % shapes.length];

            // Create new entity
            const entity = document.createElement('a-entity');
            entity.setAttribute('geometry', `primitive: ${shape}; radius: 0.2; height: 0.4`);
            entity.setAttribute('material', `color: ${color}; transparent: true; opacity: 0.8`);

            // Random position around the target
            const x = (Math.random() - 0.5) * 2;
            const y = Math.random() * 0.5;
            const z = 0.1 + Math.random() * 0.3;

            entity.setAttribute('position', `${x} ${y} ${z}`);
            entity.setAttribute('scale', '0.3 0.3 0.3');
            entity.setAttribute('animation', 'property: rotation; to: 360 360 360; loop: true; dur: 4000');
            entity.classList.add('added-object');

            targetAnchor.appendChild(entity);
            objectCount++;

            document.getElementById('instructions').innerHTML = `‚úÖ ${objectCount} objects added! Point at target image to see them.`;
        }

        // Log loading status
        console.log('MindAR loading...');

        // Handle any errors
        window.addEventListener('error', (e) => {
            console.error('Error:', e.error);
            document.getElementById('instructions').innerHTML = '‚ùå Error loading AR. Check console for details.';
        });
    </script>
</body>
</html>